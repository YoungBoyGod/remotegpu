# 前端需求与方案反馈建议

**日期**: 2026-02-03
**来源**: 需求文档与开发计划深度评审

本文件汇总了基于管理员（运营者）和企业客户（使用者）双重视角的需求分析反馈，以及工程化实现的改进建议。

---

## 一、管理员端体验优化建议 (Admin Perspective)

### 1. 计费与状态感知的增强
*   **问题**: 目前设计侧重于资源“分配”，对“计费状态”的视觉强提示不足。
*   **建议**:
    *   增加**欠费/即将到期**的强视觉标识（如红色倒计时徽章）。
    *   在机器列表或客户详情中增加**“一键锁机”**（软停机）功能，用于处理欠费或违规情况，而不仅仅是“回收”。

### 2. 机器维护状态的可视化
*   **问题**: 物理机（Bare Metal）重装系统或硬件维护耗时较长，目前状态仅区分“在线/离线”，容易造成管理员误判机器故障。
*   **建议**:
    *   引入**“维护中/重装中”**的中间状态。
    *   若后端支持，在前端显示**重装进度条**（如：OS Installation 40%），避免管理员在重装期间误操作或焦虑。

### 3. 争议解决与审计增强
*   **问题**: 客户若误删数据或搞坏环境引发纠纷，目前缺乏直观的证据链。
*   **建议**:
    *   在客户详情页增加**敏感操作审计日志**视图。
    *   记录关键动作：系统重置、磁盘格式化、大量文件删除、数据集卸载等。

---

## 二、客户端体验优化建议 (Customer Perspective)

### 1. 大规模文件管理的性能瓶颈
*   **问题**: AI 训练场景常涉及海量小文件（如 ImageNet 数据集含百万张图片）。Web 端“文件浏览器”若无特殊处理，极易在加载目录时卡死浏览器。
*   **建议**:
    *   后端接口必须支持分页或游标加载。
    *   前端文件树组件需限制单层显示数量（如超过 500 个文件显示“加载更多”），或采用**虚拟滚动**技术。

### 2. 网络连接信息的透明度
*   **问题**: 业务涉及内网穿透/端口映射。如果前端仅显示基础 IP，客户可能无法区分是内网 IP 还是公网 IP，导致连接失败。
*   **建议**:
    *   **一键复制命令标准化**: 前端生成的 SSH 命令必须是**最终可用**的（包含映射后的公网 IP 和非标准端口，例如 `ssh -p 10022 user@203.x.x.x`）。
    *   明确标识网络类型：在机器卡片上清晰标注“公网直连”或“端口映射”。

### 3. 团队协作可视性
*   **问题**: 企业客户通常是团队使用。目前的视图可能难以区分“机器是被我占用了”还是“被同事占用了”。
*   **建议**:
    *   在机器列表增加**“当前使用者”**标记。
    *   区分“个人独占”与“团队共享”视图，避免团队成员撞车。

---

## 三、工程化与技术实现建议 (Technical & Engineering)

### 1. Mock 策略优化
*   **建议**: 引入 **MSW (Mock Service Worker)** 或在 API 层构建统一的 Mock 开关。避免在组件内部硬编码假数据，确保后期与后端联调时能平滑切换，不污染业务代码。

### 2. 全局错误处理 (Error Handling)
*   **建议**: 建立统一的 HTTP 拦截器和全局错误 UI 机制。
    *   API 请求失败时统一弹出 Toast 提示。
    *   Token 过期自动跳转登录。
    *   避免在每个业务组件中重复编写 `try-catch` 处理通用网络错误。

### 3. WebSocket 健壮性封装
*   **建议**: 针对实时监控和日志流，封装统一的 WebSocket 客户端类。
    *   必须包含 **心跳检测 (Heartbeat)**。
    *   必须包含 **断线自动重连 (Auto-reconnect)** 机制（带指数退避策略）。
    *   处理页面切换/休眠后的连接恢复，防止监控数据假死。

### 4. 关键链路 E2E 测试
*   **建议**: 虽然资源有限，但建议使用 Playwright 对**核心闭环**进行端到端测试覆盖：
    *   Admin 登录 -> 分配机器。
    *   Customer 登录 -> 看到机器 -> 复制 SSH 命令。
    *   保证每次发版核心业务流不挂。
