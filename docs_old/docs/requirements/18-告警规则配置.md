# 告警规则配置

> 所属模块：模块 9 - 监控告警模块
>
> 功能编号：9.2
>
> 优先级：P2（可选）

---

## 1. 功能概述

### 1.1 功能描述

告警规则配置功能支持用户自定义监控告警规则，当资源使用率、服务状态等指标异常时自动触发告警，通过邮件、短信、钉钉等方式通知用户。

### 1.2 业务价值

- ✅ 及时发现系统异常
- ✅ 灵活的告警规则配置
- ✅ 多种告警通知方式
- ✅ 告警历史记录和分析

---

## 2. 告警类型

### 2.1 告警级别

| 级别 | 说明 | 响应时间 |
|------|------|---------|
| critical | 严重告警 | 立即处理 |
| warning | 警告告警 | 1 小时内处理 |
| info | 信息告警 | 记录即可 |

### 2.2 告警指标

```yaml
告警指标:
  主机指标:
    - cpu_usage_percent > 90
    - memory_usage_percent > 85
    - disk_usage_percent > 90

  GPU 指标:
    - gpu_utilization > 95
    - gpu_temperature > 85
    - gpu_memory_usage > 90

  服务指标:
    - service_down
    - response_time > 5000ms
```

---

## 3. 数据模型

```sql
CREATE TABLE alert_rules (
    id BIGSERIAL PRIMARY KEY,
    name VARCHAR(128) NOT NULL,
    metric VARCHAR(64) NOT NULL,
    operator VARCHAR(16) NOT NULL,
    threshold FLOAT NOT NULL,
    severity VARCHAR(16) DEFAULT 'warning',
    status VARCHAR(20) DEFAULT 'active',
    created_at TIMESTAMP DEFAULT NOW()
);
```

---

## 4. API 接口

```go
POST /api/alerts/rules
Body: {
  "name": "CPU 使用率过高",
  "metric": "cpu_usage_percent",
  "operator": ">",
  "threshold": 90,
  "severity": "warning"
}
```

---

## 5. 测试用例

| 用例 | 场景 | 预期结果 |
|------|------|---------|
| TC-01 | 创建告警规则 | 规则创建成功 |
| TC-02 | 触发告警 | 发送告警通知 |

---

**文档版本：** v1.0
**创建日期：** 2026-01-26
