# 工作空间管理

> 所属模块：模块 2 - 用户与权限模块
>
> 功能编号：2.2
>
> 优先级：P1（重要）

---

## 1. 功能概述

### 1.1 功能描述

工作空间管理功能支持团队协作，允许用户创建工作空间并邀请成员加入，实现资源共享和权限隔离，为团队提供统一的开发环境管理平台。

### 1.2 业务价值

- ✅ 支持团队协作开发
- ✅ 资源共享和权限隔离
- ✅ 统一的成员管理
- ✅ 项目级别的资源配额

---

## 2. 核心功能

### 2.1 工作空间类型

| 类型 | 说明 | 成员数量 | 适用场景 |
|------|------|---------|---------|
| personal | 个人空间 | 1 | 个人开发 |
| team | 团队空间 | 2-50 | 小团队协作 |
| enterprise | 企业空间 | 无限制 | 大型企业 |

### 2.2 成员角色

| 角色 | 权限 |
|------|------|
| owner | 所有权限，包括删除空间 |
| admin | 管理成员、创建环境、配置资源 |
| member | 创建和管理自己的环境 |
| viewer | 只读权限，查看资源 |

---

## 3. 数据模型

```sql
CREATE TABLE workspaces (
    id BIGSERIAL PRIMARY KEY,
    uuid VARCHAR(64) UNIQUE NOT NULL,
    owner_id BIGINT NOT NULL,
    name VARCHAR(128) NOT NULL,
    description TEXT,
    type VARCHAR(20) DEFAULT 'team',
    status VARCHAR(20) DEFAULT 'active',
    member_count INT DEFAULT 1,
    created_at TIMESTAMP DEFAULT NOW(),
    FOREIGN KEY (owner_id) REFERENCES customers(id)
);

CREATE TABLE workspace_members (
    id BIGSERIAL PRIMARY KEY,
    workspace_id BIGINT NOT NULL,
    customer_id BIGINT NOT NULL,
    role VARCHAR(20) NOT NULL,
    status VARCHAR(20) DEFAULT 'active',
    joined_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT NOW(),
    FOREIGN KEY (workspace_id) REFERENCES workspaces(id),
    FOREIGN KEY (customer_id) REFERENCES customers(id),
    UNIQUE(workspace_id, customer_id)
);
```

---

## 4. API 接口

### 4.1 创建工作空间

```go
POST /api/workspaces
Body: {
  "name": "AI Research Team",
  "description": "深度学习研究团队",
  "type": "team"
}

Response: {
  "workspace_id": "ws-abc123",
  "status": "active"
}
```

### 4.2 邀请成员

```go
POST /api/workspaces/:id/members
Body: {
  "email": "member@example.com",
  "role": "member"
}

Response: {
  "invitation_id": "inv-xyz789",
  "status": "sent"
}
```

---

## 5. 前端界面

```vue
<template>
  <el-card>
    <h3>工作空间管理</h3>

    <el-button type="primary" @click="createWorkspace">
      创建工作空间
    </el-button>

    <el-table :data="workspaces" style="margin-top: 20px">
      <el-table-column prop="name" label="名称" />
      <el-table-column prop="type" label="类型" />
      <el-table-column prop="member_count" label="成员数" />
      <el-table-column label="操作">
        <template #default="{ row }">
          <el-button size="small" @click="manageMembers(row)">
            管理成员
          </el-button>
        </template>
      </el-table-column>
    </el-table>
  </el-card>
</template>
```

---

## 6. 测试用例

| 用例 | 场景 | 预期结果 |
|------|------|---------|
| TC-01 | 创建工作空间 | 创建成功 |
| TC-02 | 邀请成员 | 发送邀请邮件 |
| TC-03 | 成员接受邀请 | 加入工作空间 |
| TC-04 | 移除成员 | 成员被移除 |

---

**文档版本：** v1.0
**创建日期：** 2026-01-26
