# CodeX 前端需求草案（v0.1 / 2026-02-04）

> 说明：先对齐最小可用前端需求，后续随功能演进持续补充。

## 目标用户与角色

- 管理员（Admin）
- 客户（Customer）

## 通用要求

- 登录态：支持 access/refresh token 自动续期。
- 权限：Admin 与 Customer 页面严格隔离。
- 列表：支持分页、筛选、空状态、加载态。
- 错误提示：按后端 `code` 与 `msg` 统一处理。
- 时间格式：统一为本地时间展示。

## 登录与认证

- 登录页面
  - 用户名/密码
  - 登录失败提示（账号禁用、密码错误）
  - 登录成功后跳转到对应角色首页
- 首次登录强制改密
  - 后端返回 `must_change_password=true` 时仅允许访问改密页
  - 改密成功后跳转回角色首页
- 刷新登录态
  - refresh token 失效时回到登录页

## 管理端（Admin）页面

### 1) 仪表盘
- 统计卡片：机器总数、已分配、空闲、离线、活跃客户数
- GPU 使用趋势（若后端未接入真实数据则展示占位）
- 最近分配记录列表（主机、客户、起止时间）

### 2) 机器管理
- 列表：按状态/区域/GPU 型号筛选
- 创建机器：仅填写基础信息与登录信息，硬件配置自动采集
  - 连接地址支持 IP/域名/hostname
  - SSH 私钥或密码至少填写一个
  - 支持补采硬件信息（管理员触发）
- 批量导入：JSON 上传或表单粘贴
- 分配：选择客户 + 租期
- 回收：确认提示

### 3) 客户管理
- 列表/分页
- 创建客户（用户名、公司代号、邮箱、初始密码；公司名称可选）
- 禁用客户

### 4) 镜像管理
- 列表：category/framework/status 筛选
- 同步镜像（按钮触发）

### 5) 审计日志
- 列表：action/resource_type/username/time 范围筛选
- 仅读展示

### 6) 监控与告警
- 实时监控快照
- 告警列表 + 确认操作

## 客户端（Customer）页面

### 1) 我的机器
- 列表：显示分配信息与到期时间
- 查看连接信息
- 触发 SSH 重置
- 添加机器：提交连接信息并查看添加进度
  - SSH 私钥或密码至少填写一个
  - 提交接口：`POST /api/v1/customer/machines`

### 2) 任务管理
- 列表：状态/时间
- 创建训练任务（表单）
- 停止任务

### 3) 数据集
- 列表/分页
- 初始化分片上传（展示 upload_id 与 chunk_size）
- 挂载数据集到机器（选择机器 + 挂载路径）

### 4) SSH Key
- 列表
- 新增/删除
- 显示指纹

## 待补充项（后续完善）

- 远程访问（VNC/RDP/Guacamole）前端入口
- 镜像同步进度/状态展示
- 机器回收清理进度展示
