groups:
  - name: service_alerts
    rules:
      # 服务宕机告警
      - alert: ServiceDown
        expr: up == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "服务 {{ $labels.job }} 宕机"
          description: "目标 {{ $labels.instance }} 已超过 1 分钟无响应"

      # Prometheus 配置重载失败
      - alert: PrometheusConfigReloadFailed
        expr: prometheus_config_last_reload_successful == 0
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "Prometheus 配置重载失败"

      # Agent 离线超过 5 分钟
      - alert: AgentOffline
        expr: up{job="node-exporter"} == 0
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: "Agent 离线 ({{ $labels.instance }})"
          description: "节点 {{ $labels.instance }} 的 Agent 已离线超过 5 分钟"

      # 后端服务离线
      - alert: BackendServiceDown
        expr: up{job="remotegpu-backend"} == 0
        for: 2m
        labels:
          severity: critical
        annotations:
          summary: "RemoteGPU 后端服务离线"
          description: "后端服务 {{ $labels.instance }} 已离线超过 2 分钟"
